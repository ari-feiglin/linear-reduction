\catcode`@=11\relax

\def\gobble#1{}

\def\ccoloneqq{\mathrel{{\mathop:}{\mathop:}{=}}}

\let\bb=\mathbb
\def\bN{\bb N}
\def\bZ{\bb Z}
\def\bbN{\overline\bN}
\def\bbZ{\overline\bZ}
\let\partial=\rightharpoonup
\let\longto=\longrightarrow
\def\sX{\mathsf X}
\let\epsilon=\varepsilon
\def\oS{\overline\Sigma}
\def\oP{\overline\Pi}
\def\hb{\widehat\beta}

\let\oo=\infty

\def\@set#1[#2]{\left\{\,#1\;\middle|\;#2\,\right\}}
\def\@@set#1{\left\{#1\right\}}
\def\set#1{\@ifnextchar[ {\@set{#1}}{\@@set{#1}}}
\def\@gen#1[#2]{\left<\,#1\;\middle|\;#2\,\right>}
\def\@@gen#1{\left<#1\right>}
\def\gen#1{\@ifnextchar[ {\@gen{#1}}{\@@gen{#1}}}
\def\abs#1{\left|#1\right|}

\let\ttt=\texttt

\def\fboxsep{.5pt}
\def\mb#1{{}\mathop{\fbox{\vrule width0pt depth1.5pt height8pt$#1$}}\nolimits{}}
\def\mbt#1{{}\mathop{\fbox{\vrule width0pt depth1.5pt height8pt\ttt{#1}}}\nolimits{}}

\def\fst{\mathsf{fst}}
\def\snd{\mathsf{snd}}
\def\pop{\textsl{pop}}

\def\NUM{\mathsf{Num}}
\def\OP{\mathsf{Op}}
\def\LPAREN{\mathsf{Lparen}}
\def\RPAREN{\mathsf{Rparen}}
\def\LIST{\mathsf{List}}
\def\PRODUCT{\mathsf{Product}}

\def\values{\mathcal U}

\def\term{\mathcal T}
\def\termp{\term_{\mathcal P}}
\def\terms{\term_{\Sigma}}
\def\terma{\term_{\mathcal A}}
\def\termi{\term_{\mathcal I}}
\def\exp{\Pi}
\def\expi{\exp_{\mathcal I}}
\def\oe{\overline\exp}

\def\state{\mathrm{State}}
\def\dom{\operatorname{dom}}

\def\NEEDCITE#1{}

\let\gbar=\mid
\def\bbar{\hphantom{{}\ccoloneqq}\gbar}
\def\grammar{%
    \bgroup\tabskip=0pt plus 1fil\halign to\hsize\bgroup\it\hfil##\tabskip=\z@& ${}##$\hfil\tabskip=0pt plus 1fil\crcr
}
\def\egrammar{%
    \crcr\egroup\egroup%
}
\def\({\hbox{\tt(}}
\def\){\hbox{\tt)}}

\def\astyle{\textsf}
\def\tstyle#1{\underline{\mathsf{#1}}}
\def\istyle#1{\mb{\mathsf{#1}}}
\def\asig{{\astyle\sigma}}
\def\aOmeg{{\astyle\Omega}}
\def\tsig{{\tstyle\sigma}}
\def\ttau{{\tstyle\tau}}
\def\tOmeg{{\tstyle\Omega}}
\def\isig{\istyle{\sigma}}
\def\iOmeg{\istyle{\Omega}}
\def\op{\astyle{op}}
\def\Pop{\astyle{pop}}
\def\tp{\tstyle{type}}
\def\ccolon{\astyle{colon}}
\def\typer{\astyle{typer}}
\def\num{\tstyle{num}}
\def\str{\astyle{str}}
\def\eend{\astyle{end}}
\def\lparen{\astyle{lparen}}
\def\rparen{\astyle{rparen}}
\def\listrparen{\astyle{listrparen}}
\def\vrparen{\astyle{vrparen}}
\def\comma{\astyle{comma}}
\def\period{\astyle{period}}
\def\lbuild{\astyle{lbuild}}
\def\Lbrack{\astyle{lbrack}}
\def\Rbrack{\astyle{rbrack}}
\def\Lbrace{\astyle{lbrace}}
\def\Rbrace{\astyle{rbrace}}
\def\List{\tstyle{list}}
\def\lett{\astyle{let}}
\def\letvar{\astyle{letvar}}
\def\leteq{\astyle{leteq}}
\def\sett{\astyle{set}}
\def\setvar{\astyle{setvar}}
\def\seteq{\astyle{seteq}}
\def\equal{\astyle{equal}}
\def\index{\astyle{index}}
\def\fun{\astyle{fun}}
\def\funname{\astyle{funname}}
\def\funvars{\astyle{funvars}}
\def\a{^\astyle{a}}
\def\plist{\astyle{plist}}
\def\code{\astyle{code}}
\def\iif{\astyle{if}}
\def\ifbool{\astyle{ifbool}}
\def\ifthen{\astyle{ifthen}}
\def\quote#1{\hbox{``}#1\hbox{''}}
\def\closure{\tstyle{closure}}
\def\gbble{\astyle{gobble}}
\def\match{\astyle{match}}
\def\product{\tstyle{product}}
\def\primitive{\tstyle{primitive}}
\def\Listrparen{\astyle{listrparen}}
\def\none{\tstyle{none}}
\def\minfty{{\sf minfty}}
\def\pinfty{{\sf infty}}
\def\zero{{\sf zero}}

\def\@blist[#1]{%
    \bgroup\par%
    \def\item{%
        \par\egroup\bgroup\medskip\setbox0=\hbox{#1\quad}%
        \advance\leftskip by \wd0\noindent\kern-\wd0\box0%
    }%
    \bgroup%
}
\def\blist{\@ifnextchar[ \@blist {\@blist[$\bullet$]}}
\def\elist{\par\egroup\egroup\medskip}

\font\sevenrm=cmr7
\font\tencsc=cmcsc10
\font\sevenbf=cmbx7

\newdimen\alg@indent
\newcount\line@num
\newif\if@prnum \@prnumtrue
\def\algorithm{%
    \line@num=1\relax%
    \ialign to \dimexpr\hsize-\leftskip\relax\bgroup%
        \hfil##\tabskip=.25cm&\kern\alg@indent##\hfil\tabskip=\z@\crcr
}

\def\ealgorithm{\crcr\egroup}
\def\nonum{\global\@prnumfalse}
\def\State{\crcr\relax\if@prnum{\sevenrm\the\line@num.}\global\advance\line@num by 1\relax\fi\global\@prnumtrue&}
\def\comment@indent{.3cm}
%\def\Comment{\cr&\hskip\comment@indent\hfill\vtop\bgroup\hsize=\dimexpr\hsize-\leftskip-\rightskip-1cm\relax\quitvmode\llap{$\mathchar"012E$ }\it}
\def\Comment{\cr&$\mathchar"012E$ \vtop\bgroup\halign\bgroup\it##\hfill\crcr}
\def\EndComment{\crcr\egroup\egroup}
\def\lComment{\hskip\comment@indent$\mathchar"012E$ \it}
\def\Return{\textbf{return} }

\def\textbf#1{{\bf#1}}

\def\startblock#1{%
    \State#1%
    \global\advance\alg@indent by.5cm\relax%
}
\def\endblock#1{%
    \global\advance\alg@indent by-.5cm\relax
    \State#1%
}
\def\middleblock#1{%
    \global\advance\alg@indent by-.5cm\relax
    \State#1%
    \global\advance\alg@indent by.5cm\relax%
}

\def\codeparens#1{$\left(\hbox{#1}\right)$}

\def\normblock#1#2{\gdef\args{(#2)}#1}
\def\starblock#1#2{\gdef\args{#2:}#1}
\def\starredblock#1{\@ifstar {\starblock{#1}}{\normblock{#1}}}

\def\If{\starredblock{\startblock{\textbf{if} \args}}}
\def\ElseIf{\starredblock{\middleblock{\textbf{else if} \args}}}
\def\Else{\middleblock{\textbf{else}}}
\def\EndIf{\endblock{\textbf{end if}}}
\def\While{\starredblock{\startblock{\textbf{while} \args}}}
\def\EndWhile{\endblock{\textbf{end while}}}
\def\For{\starredblock{\startblock{\textbf{for} \args}}}
\def\EndFor{\endblock{\textbf{end for}}}
\def\Repeat#1{\startblock{\textbf{repeat} #1 \textbf{times}}}
\def\EndRepeat{\endblock{\textbf{end repeat}}}
\def\Function#1#2{\startblock{\textbf{function} {\tencsc #1}\codeparens{#2}}}
\def\EndFunc{\endblock{\textbf{end function}}}
\def\Routine#1{\startblock{\textbf{routine} {\tencsc #1}}}
\def\EndRoutine{\endblock{\textbf{end routine}}}
\def\InnerText#1{\crcr\multispan2\relax#1\hfil}
\def\lIf{\starredblock{\State\textbf{if} \args\ }}
\def\lElseIf{\starredblock{\State\textbf{else if} \args\ }}
\def\lElse{\State\textbf{else} }
\def\Choose{\startblock{\textbf{choose}}\gdef\choicenum{0}}
\def\EndChoose{\endblock{\textbf{end choose}}}
\def\Choice{%
    \xdef\choicenum{\the\numexpr\choicenum +1\relax}%
    \State{\sevenbf(\choicenum)}\hskip.25cm
}

\let\gets=\leftarrow

\def\s#1{\mathsf{#1}}

\def\qed{%
    \ifmmode \eqno\mathchar"404%
    \else%
        \hskip.5cm\penalty0\null\nobreak\hfill$\mathchar"404$%
        \par\medskip%
    \fi%
}
